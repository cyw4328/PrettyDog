<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>

<!-- namespace : 이 XML 이 어떤 interface 와 연결되는지 설정 -->
<mapper namespace="com.pretty.dog.dao.PointManagementDAO">

	<!-- 포인트 충전 -->
	<insert id="pointInsert">
		INSERT INTO pointlist (mem_id,point_cdc,point_cont,point_distin)
			values (#{param2},#{param1},"포인트충전",0); 
	</insert>
	
	<!-- 회원테이블 포인트부분 수정 -->
	<update id="memPointAdd">
		update members set mem_point = (select sum(point_cdc) from pointlist where mem_id = #{param2}) where mem_id = #{param2}
	</update>

	<!-- 포인트리스트페이지 정보 -->
	<select id="memPointSelect" resultType="dog">
		SELECT * FROM members WHERE mem_id = #{param1}
	</select>
	
	<!-- 회원테이블 내역조회(페이징)-->
	<select id="allCountMemPointList" resultType="int">
		SELECT COUNT(point_num) FROM pointList WHERE mem_id = #{param1}
	</select>
	
	<!-- 회원 총 포인트 조회 -->
	<select id="memPointList" resultType="dog">
		SELECT * FROM pointList WHERE mem_id = #{param3} ORDER BY point_num DESC LIMIT #{param1} OFFSET #{param2}
	</select>
	
</mapper>